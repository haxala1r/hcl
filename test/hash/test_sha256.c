#include "../../include/hash.h"
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char *sha256_msgs[] = {
	"",
	"ABCD",
	"The quick brown fox jumps over the lazy dog"
};

uint8_t sha256_expected[][32] = {
	{0xe3,0xb0,0xc4,0x42,0x98,0xfc,0x1c,0x14,0x9a,0xfb,0xf4,0xc8,0x99,0x6f,0xb9,0x24,0x27,0xae,0x41,0xe4,0x64,0x9b,0x93,0x4c,0xa4,0x95,0x99,0x1b,0x78,0x52,0xb8,0x55},
	{0xe1,0x2e,0x11,0x5a,0xcf,0x45,0x52,0xb2,0x56,0x8b,0x55,0xe9,0x3c,0xbd,0x39,0x39,0x4c,0x4e,0xf8,0x1c,0x82,0x44,0x7f,0xaf,0xc9,0x97,0x88,0x2a,0x2,0xd2,0x36,0x77},
	{0xd7,0xa8,0xfb,0xb3,0x7,0xd7,0x80,0x94,0x69,0xca,0x9a,0xbc,0xb0,0x8,0x2e,0x4f,0x8d,0x56,0x51,0xe4,0x6d,0x3c,0xdb,0x76,0x2d,0x2,0xd0,0xbf,0x37,0xc9,0xe5,0x92}
};

int test_sha256(void) {
	int test_count = sizeof(sha256_msgs) / sizeof(*sha256_msgs);

	for (int i = 0; i < test_count; i++) {
		char *out = HCL_sha256(sha256_msgs[i], strlen(sha256_msgs[i]));

		if (memcmp(out, sha256_expected[i], 32)) {
			printf("[HCL_sha256] Test failed\n");
			return -1;
		}
	}
	printf("[HCL_sha256] Test passed\n");
	return 0;
}
